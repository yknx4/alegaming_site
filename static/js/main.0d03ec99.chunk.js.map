{"version":3,"sources":["util/streamlabs.ts","util/fb.ts","datastore/messagesDatabase.ts","util/messages.ts","loadCachedMessages.tsx","PageContext.ts","live_videos/util.tsx","live_videos/Notifies.tsx","live_videos/GenerateGiveawayWinners.tsx","live_videos/VideoHeader.tsx","hooks/useFacebookPage.ts","LiveVideoDashboard.tsx","PageSelector.tsx","widgets/RoundsWidget.tsx","widgets/Widgets.tsx","giveaway/AdvancedGiveaway.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["InvalidChatboxUrlError","Error","useChatBoxUrlState","createLocalStorageStateHook","STARTS","isValidUrl","storedUrl","JSON","parse","window","localStorage","getItem","console","log","error","startsWith","storedConfig","fetchStreamlabsConfig","a","fetch","headers","response","ok","json","config","getUserToken","streamlabsConfig","oauths","facebook_account","getUserId","usernames","getPagesTokens","pageAccessTokensResponse","getPageToken","id","tokens","data","find","t","usePersistedVideoData","useLastSelectedVideoInfo","useLastSelectedVideoComments","FbApiCall","path","params","method","Promise","resolve","reject","FB","api","errorResponse","message","getAllResults","results","allResults","push","undefined","paging","next","nextResponse","messagesDatabase","messages","version","stores","table","Dexie","videoCommentToDbMessage","videoId","pageId","toString","createdTime","created_time","user","from","name","userPicture","picture","url","userId","broadcastTimestamp","live_broadcast_timestamp","likeCount","like_count","dbMessageToVideoComment","Date","toISOString","batchInsertApiMessages","dbMessages","map","m","bulkAdd","loadCachedMessages","where","toArray","existingMessages","PageContext","createContext","formatComments","comments","c","date","DateTime","fromISO","actions","author","avatar","content","datetime","title","toLocaleString","TIME_24_WITH_SECONDS","toRelative","defaultVideoCustomState","roundSize","winners","useVideoCustomState","memoize","notifyActions","state","setMessageState","key","priority","onClick","createElement","StarFilled","StarOutlined","down","ArrowUpOutlined","ArrowDownOutlined","hidden","React","EyeOutlined","EyeInvisibleOutlined","defaultMessageState","formatNotifies","videoState","setVideoState","messageId","messageState","prevState","currentMessageState","newMessageState","TIME_WITH_SECONDS","NotifiesList","props","perPage","text","useParams","useState","currentPage","setPage","offset","className","header","length","itemLayout","dataSource","slice","renderItem","item","current","onChange","p","total","showSizeChanger","defaultPageSize","showTotal","range","defaultCurrent","generateNotifiesForRound","notifies","currentState","withoutSpecialCases","filter","n","movedDown","includes","generateNotifies","pageName","uniqBy","orderBy","toMillis","toLowerCase","GenerateGiveawayWinners","useContext","page","videos","loadMessages","video","v","useEffect","effect","status","type","sampleSize","Paragraph","Typography","Content","children","extraContent","style","flex","WinnersList","w","VideoHeader","liveVideo","history","useHistory","videoTime","creation_time","onBack","goBack","subTitle","DATETIME_MED","tags","color","extra","target","href","permalink_url","src","icon","alt","width","description","useFacebookPage","loadingVideos","setLoadingVideos","setVideos","pageData","setPageData","tokenItem","access_token","fields","Layout","defaultMessageParams","limit","live_filter","order","VideoCard","span","LoadingOutlined","VideoCameraOutlined","bordered","hoverable","cover","Meta","CurrentVideos","margin","Item","padding","minHeight","gutter","CommentsList","CommentsFeed","loaded","setLoaded","setComments","setLastSelectedVideoComments","composedSetComments","since","broadcast_start_time","sortBy","reverse","interval","setInterval","newComments","prev","clearInterval","filteredNotifies","defaultValue","tooltipVisible","value","setRoundSize","i","round","printRoundLine","LiveVideoDashboard","persistedVideoData","setPersistedVideoData","setLastSelectedVideo","loading","setLoading","to","LiveVideosDashboard","match","useRouteMatch","Provider","size","CollectionCreateForm","visible","onCreate","onCancel","chatboxUrl","Form","useForm","form","okText","cancelText","onOk","validateFields","then","values","resetFields","catch","info","layout","initialValues","label","rules","required","addonAfter","SettingOutlined","placeholder","UpdateChatboxUrl","setVisible","setChatboxUrl","PageSelector","RoundsWidget","videoInfo","notifiesForRound","separateRounds","chunk","Widgets","hasTagged","message_tags","split","GiveawayData","postUrl","setPostUrl","reactions","setReactions","postId","r","reply","allComments","allReactions","didReact","participants","prefix","FacebookOutlined","enterButton","SaveOutlined","onSearch","AdvancedGiveaway","Footer","Sider","SubMenu","Menu","getSelectedMenuItemKey","Sidebar","showPageSelector","pages","setPages","tokensResponse","collapsed","setCollapsed","useLocation","collapsible","onCollapse","theme","defaultSelectedKeys","mode","selectedKeys","pathname","DashboardOutlined","UnorderedListOutlined","GiftOutlined","NormalPage","loggedIn","setLoggedIn","textAlign","App","basename","Boolean","location","hostname","fbAsyncInit","init","appId","autoLogAppEvents","xfbml","cookie","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.0d03ec99.chunk.js","sourcesContent":["import { last } from 'lodash'\nimport { createLocalStorageStateHook } from 'use-local-storage-state'\nimport { StreamLabsConfig } from './streamlabs.definitions'\n\nexport class InvalidChatboxUrlError extends Error {}\n\nexport const useChatBoxUrlState = createLocalStorageStateHook<string>('chatboxUrl')\n\nconst STARTS = 'https://streamlabs.com/widgets/chat-box/v1/'\nexport function isValidUrl() {\n  const storedUrl = JSON.parse(window.localStorage.getItem('chatboxUrl') ?? '\"\"')\n  console.log('storedUrl', storedUrl)\n  if (storedUrl === null) {\n    console.error('storedUrl is null')\n    return false\n  }\n  if (!storedUrl.startsWith(STARTS)) {\n    console.error(`storedUrl <${storedUrl}> doesn't start with <${STARTS}>.`)\n    return false\n  }\n  return true\n}\n\nexport function getStreamlabsToken() {\n  return new Promise<string>((resolve, reject) => {\n    if (isValidUrl()) {\n      const url = JSON.parse(window.localStorage.getItem('chatboxUrl') ?? '\"\"') as string\n      resolve(last(url.split('/')))\n    } else {\n      reject(new InvalidChatboxUrlError('localStorage.chatboxUrl is empty or invalid.'))\n    }\n  })\n}\n\nlet storedConfig: StreamLabsConfig | null = null\nexport async function fetchStreamlabsConfig() {\n  if (storedConfig !== null) {\n    return storedConfig\n  }\n  const storedUrl = JSON.parse(window.localStorage.getItem('chatboxUrl') ?? '\"\"')\n  const response = await fetch(`https://murmuring-plateau-21894.herokuapp.com/?url=${storedUrl}`, {\n    headers: {\n      'x-token': 'eQ1z8bmURCR2Odtg4NR8M'\n    }\n  })\n  if (!response.ok) {\n    throw new InvalidChatboxUrlError('localStorage.chatboxUrl is empty or invalid.')\n  }\n  const config = (await response.json()) as StreamLabsConfig\n  storedConfig = config\n  return config\n}\n","import { createLocalStorageStateHook } from 'use-local-storage-state'\nimport { PageToken, PageTokensResponse } from \"../definitions\"\nimport { FacebookPaginatedResponse, VideoComment } from \"./fb.definitions\"\nimport { fetchStreamlabsConfig } from \"./streamlabs\"\n\nexport class InvalidFacebookUserTokenError extends Error {}\nexport class InvalidFacebookPageTokenError extends Error {}\n\n\nexport interface FacebookMe {\n  name: string\n}\n\nexport interface HasError {\n  error: any\n}\n\nexport async function getUserToken(): Promise<string> {\n  const streamlabsConfig = await fetchStreamlabsConfig()\n  return streamlabsConfig.oauths.facebook_account\n}\n\nexport async function getUserId(): Promise<string> {\n  const streamlabsConfig = await fetchStreamlabsConfig()\n  return streamlabsConfig.usernames.facebook_account\n}\n\nexport async function getPagesTokens(): Promise<PageTokensResponse> {\n  const pageAccessTokensResponse = await fetch(`https://graph.facebook.com/${await getUserId()}/accounts?access_token=${await getUserToken()}`)\n  return pageAccessTokensResponse.json() \n}\n\nexport async function getPageToken(id: string) {\n  const tokens = await getPagesTokens()\n  return tokens.data.find(t => t.id === id)\n}\n\nexport interface SelectedVideoInfo {\n  id: string,\n  page: PageToken\n}\n\nexport type PersistedVideoData = Record<string, boolean>\nexport const usePersistedVideoData = createLocalStorageStateHook<PersistedVideoData>('persistedVideoData', {})\nexport const useLastSelectedVideoInfo = createLocalStorageStateHook<SelectedVideoInfo>('lastSelectedVideoInfo')\nexport const useLastSelectedVideoComments = createLocalStorageStateHook<VideoComment[]>('lastSelectedVideoComments', [])\n\ninterface FbError {\n  error: string | unknown\n}\n\nexport interface FbParams {\n  access_token: string;\n  fields: string;\n  limit?: number\n  live_filter?: 'no_filter' | 'filter_low_quality'\n  order?: 'chronological' | 'reverse_chronological'\n  since?: string\n}\n\nexport function FbApiCall<T = unknown>(path: string, params: FbParams, method: \"get\" | \"post\" | \"delete\" = 'get'): Promise<T> {\n  return new Promise((resolve, reject) => {\n    FB.api(\n      path,\n      method,\n      params,\n      function (response: T | FbError | undefined) {\n        if(response == null) {\n          reject(new Error('Empty Response'))\n        }\n        if((response as FbError).error != null) {\n          const errorResponse = response as FbError\n          const message = typeof errorResponse.error === 'string' ? errorResponse.error : 'FB Api Error'\n          console.error(response)\n          reject(new Error(message))\n        }\n        resolve(response as T)\n      }\n    );\n  })\n}\n\nexport async function getAllResults<T extends FacebookPaginatedResponse>(results: T) {\n  let allResults: T['data'] = []\n\n  allResults.push(...results.data)\n  while (results.paging?.next !== undefined) {\n    const nextResponse = await fetch(results.paging.next)\n    results = await nextResponse.json()\n    allResults.push(...results.data)\n  }\n  return allResults\n}","import Dexie from 'dexie';\n\nexport interface Message {\n  id?: string;\n  message?: string;\n  createdTime?: string;\n  broadcastTimestamp?: number;\n  user?: string\n  userId?: string\n  userPicture?: string\n  pageId?: string\n  videoId?: string\n  likeCount?: number\n}\n\n//\n// Declare Database\n//\nclass MessageDatabase extends Dexie {\n  public messages: Dexie.Table<Message, string>; // id is number in this case\n\n  public constructor() {\n    super(\"MessageDatabase\");\n    this.version(5).stores({\n      messages: \"id,user,pageId,videoId,[message+user],[message+videoId],[message+userId]\"\n    });\n    this.messages = this.table(\"messages\");\n  }\n}\n\nexport const messagesDatabase = new MessageDatabase();","import { Message, messagesDatabase } from \"../datastore/messagesDatabase\";\nimport { VideoComment } from \"./fb.definitions\";\n\nfunction videoCommentToDbMessage(message: VideoComment, videoId: string, pageId: string): Required<Message> {\n  return {\n    id: message.id.toString(),\n    message: message.message,\n    createdTime: message.created_time,\n    user: message.from.name,\n    pageId,\n    userPicture: message.from.picture.data.url,\n    userId: message.from.id,\n    broadcastTimestamp: message.live_broadcast_timestamp,\n    videoId,\n    likeCount: message.like_count\n  }\n}\n\nexport function dbMessageToVideoComment(message: Message): VideoComment {\n  return {\n    id: message.id ?? '',\n    message: message.message ?? 'Unknown Message',\n    created_time: message.createdTime ?? new Date().toISOString(),\n    like_count: message.likeCount ?? 0,\n    live_broadcast_timestamp: message.broadcastTimestamp ?? 0,\n    from: {\n      id: message.userId ?? '',\n      name: message.user ?? 'Unknown Name',\n      picture: {\n        data: {\n          url: message.userPicture ?? 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxQHBhIRBxIOExAQEREVFxYVDRcVExIVGBIWFhUSFRUYHSggGh0lGxcVLTEhJSkrLi4uFx8zODMsNygtLisBCgoKDQ0NFQ4PEjEZFRkrKysrLTctLSsrKzctNysrLSsrNy0tKysrKy0rLSsrKysrKysrKystLSsrKysrKysrK//AABEIAOEA4QMBIgACEQEDEQH/xAAbAAEAAwEBAQEAAAAAAAAAAAAAAwQFBgIBB//EADUQAQABAgMDCQcEAwEAAAAAAAABAgMEBRESITETQVFhcYGhscEUIjI0kdHwQlKS4SRy8SP/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAMAwEAAhEDEQA/AP0wBpAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHqiiblWlETMg8vsRrOkcV2jLKqvjmmPGWjh8NTh6fcjf088mjMtZdXX8WlPbx+kJ4yr91U/xaQmqzpyqOaqf4o68rqj4KontjRqhowbuErtfHTOnTG+EDpVTE4Gm9GtO6rp6e2DUxij3dtTZr0uRv/N8PCgAAAAAAAAAAAAAAAAAA3MDh+Qsxr8U75+zHw9O3iKY6aodClABFAAAAAAQYzDxiLWnPHCWFMaTpPGHSMjNbWxfiqP1ecfkLBRAVAAAAAAAAAAAAAAAAFnL41xlPf5S3GHlvzlPf5S3EpABFAAAAAAFLNaNrC6/tmPt6rqtmM/4dWvV5wDDAaQAAAAAAAAAAAAAAABZy75ynv8pbjCwE6Yynt9JbqVQBAAAAAAAYmZVTOLmJmdI07t0Ntg46dcZV2+iwQAKgAAAAAAAAAAAAAAACfBRPtNMxE7qo5m8hwdGxhqYp6In6pkqgCAAAAAAAwMXExiatqJjWqebrb6pmdG1hJmeMaTH1WDFAVAAAAAAAAAAAAAAAAG5l9e3hKerd9Flm5Pc3VUz2+k+jSZqgAAAAAAAClm1ezhtP3THhv+y6yc2ubV6KY/THjKwUAFQAAAAAAAAAAAAAAABJh702LsVU/wDYbeFv+0WdqI047tWA08nubqqZ7fSfQo0gGVAAAAAAQYvEez2tdNd+nFh3bk3LkzVxmWhnFe+mmOufSPVmtRAAAAAAAAAAAAAAAAAABNhL3IYiJnhwnsQgOlidY3CllVya7GlX6Z0hdZUAAAABWzGuaMJOzz6R9QZWMu8tiZmOHCOyEANIAAAAAAAAAAAAAAAAAAAA2MpjTDT11T5RC6rZfTsYOnr1n6zqssqAAAAK2YxtYOru84WUeIp27FURz0zHgDngGkAAAAAAAAAAAAAAAAAAHqinbriKeMzoUUzXVpREzLVwGC5Gdq78XkC7TGzTERzQ+gyoAAAAADn8Vb5LEVR1+E8ETbx2E9op1p3VRw6+qWPctzaq0uRMS1EeAAAAAAAAAAAAAAB9iNqdKd8r2Hy2a997dHRz/wBAo007c6URMz1L+Hyyat9+dI6I4tGzZps06W4iPOe9ImmI7VmmzTpbiISAigAAAAAAADzctxcp0riJh6AZmIyznsT3T6Sz7lubdWlyJiXRvFy3F2nS5ETC6mOdGjiMs034ee6fSVCuiaKtK4mJ61HkAAAAAAH2N87gfFvC4Gq9vq92nxnshbwWA2I2r++ejmj+19NENjD02I/847+ee9MCKAAAAAAAAAAAAAAAAI71mm9TpciJ/OlIAyMVl8299r3o8Y+6i6VTxmBi/GtG6rwntXUYw9VUzRVMVRpMPKgAA0sqw2vv1933Z1MbVURHGZ0dFbo5O3EU8IjQo9AMqAAAAAAAAAAAAAAAAAAAAAAo5nh9u3t08aePXDIdLMaxvc9ft8leqp6J8OZYiMBRLhfmaP8AanzdACUgAigAAAAAAAAAAAAAAAAAAAAADEzL5yru8oBYKoCsv//Z'\n        }\n      }\n    }\n  }\n}\n\nexport async function batchInsertApiMessages(messages: VideoComment[], videoId: string, pageId: string) {\n  const dbMessages = messages.map((m) =>  videoCommentToDbMessage(m, videoId, pageId))\n  return await messagesDatabase.messages.bulkAdd(dbMessages)\n}\n\nexport async function insertOrUpdateMessage(message: VideoComment, videoId: string, pageId: string) {\n  const {id, ...allMessage} = videoCommentToDbMessage(message, videoId, pageId)\n  if(await messagesDatabase.messages.get(id) === undefined) {\n    return await messagesDatabase.messages.add({id, ...allMessage})\n  } else {\n    return await messagesDatabase.messages.update(id, allMessage)\n  }\n}\n","import { dbMessageToVideoComment } from './util/messages';\nimport { messagesDatabase } from './datastore/messagesDatabase';\n\nexport async function loadCachedMessages(videoId: string) {\n  const existingMessages = await messagesDatabase.messages.where({ videoId: videoId }).toArray();\n  return existingMessages.map(dbMessageToVideoComment);\n}\n","import { createContext } from \"react\";\nimport { LiveVideo, PageToken } from \"./definitions\";\n\nexport interface PageContextValue {page: PageToken, videos: LiveVideo[]}\nexport const PageContext = createContext<PageContextValue | undefined>(undefined)","import { Tooltip } from \"antd\"\nimport React from \"react\"\nimport { createLocalStorageStateHook } from 'use-local-storage-state'\nimport { memoize } from \"lodash\"\nimport { DateTime } from \"luxon\"\nimport { CommentUser, VideoComment } from \"../util/fb.definitions\"\n\nexport function formatComments(comments: VideoComment[]) {\n  return comments.map((c) => {\n    const date = DateTime.fromISO(c.created_time)\n    return {\n      actions: [],\n      author: c.from.name,\n      avatar: c.from.picture.data.url,\n      content: <p>{c.message}</p>,\n      datetime: (\n        <Tooltip title={date.toLocaleString(DateTime.TIME_24_WITH_SECONDS)}>\n          <span>{date.toRelative()}</span>\n        </Tooltip>\n      )\n    }\n  })\n}\nexport interface CustomVideoState {\n  messages: Record<string, CustomMessageState>\n  roundSize: number\n  winners?: CommentUser[]\n}\nexport interface CustomMessageState {\n  priority: boolean\n  hidden: boolean\n  down: boolean\n}\nexport const defaultVideoCustomState: CustomVideoState = {\n  roundSize: 5,\n  messages: {},\n  winners: []\n}\nexport const useVideoCustomState = memoize((videoId: string) => createLocalStorageStateHook<CustomVideoState>(`custom-video-settings-${videoId}`, defaultVideoCustomState))\n\nexport const COMMENTS_PER_PAGE = 10","import { ArrowDownOutlined, ArrowUpOutlined, EyeInvisibleOutlined, EyeOutlined, StarFilled, StarOutlined } from '@ant-design/icons'\nimport { List, Pagination, Comment, Tooltip } from 'antd'\nimport { uniqBy, orderBy } from 'lodash'\nimport { DateTime } from 'luxon'\nimport React, { createElement, FC, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { VideoComment } from '../util/fb.definitions'\nimport { COMMENTS_PER_PAGE, CustomMessageState, CustomVideoState, useVideoCustomState } from './util'\n\ninterface NotifiesListProps {\n  comments: VideoComment[]\n  perPage: number\n  text: string\n}\n\nfunction notifyActions(state: CustomMessageState, setMessageState: (messageState: Partial<CustomMessageState>) => void) {\n  return [\n    <Tooltip key=\"comment-priority\" title={state.priority ? 'Normal' : 'Priority'}>\n      <span\n        onClick={() => {\n          setMessageState({ priority: !state.priority })\n        }}\n      >\n        {createElement(state.priority ? StarFilled : StarOutlined)}\n      </span>\n    </Tooltip>,\n    <Tooltip key=\"comment-basic-position\" title={state.down ? 'Move Up' : 'Move Down'}>\n      <span\n        onClick={() => {\n          setMessageState({ down: !state.down })\n        }}\n      >\n        {createElement(state.down ? ArrowUpOutlined : ArrowDownOutlined)}\n      </span>\n    </Tooltip>,\n    <Tooltip key=\"comment-basic-hide\" title={state.hidden ? 'Show' : 'Hide'}>\n      <span\n        onClick={() => {\n          setMessageState({ hidden: !state.hidden })\n        }}\n      >\n        {React.createElement(state.hidden ? EyeOutlined : EyeInvisibleOutlined)}\n      </span>\n    </Tooltip>\n  ]\n}\n\nexport const defaultMessageState: CustomMessageState = { hidden: false, down: false, priority: false }\n\nfunction formatNotifies(\n  comments: VideoComment[],\n  videoState: CustomVideoState,\n  setVideoState: React.Dispatch<React.SetStateAction<CustomVideoState>>\n) {\n  const setMessageState = (messageId: string) => (messageState: Partial<CustomMessageState>) => {\n    setVideoState((prevState) => {\n      const currentMessageState = prevState.messages[messageId] ?? defaultMessageState\n      const newMessageState = { ...currentMessageState, ...messageState }\n      return { ...prevState, messages: { ...prevState.messages, [messageId]: newMessageState } }\n    })\n  }\n  return comments.map((c) => {\n    const date = DateTime.fromISO(c.created_time)\n    const messageState = videoState.messages[c.id] ?? defaultMessageState\n    return {\n      actions: notifyActions(messageState, setMessageState(c.id)),\n      author: c.from.name,\n      avatar: c.from.picture.data.url,\n      content: <p>{c.message}</p>,\n      datetime: (\n        <Tooltip title={date.toLocaleString(DateTime.TIME_WITH_SECONDS)}>\n          <span>{date.toRelative()}</span>\n        </Tooltip>\n      )\n    }\n  })\n}\n\nexport const NotifiesList: FC<NotifiesListProps> = (props) => {\n  const { comments, perPage, text } = props\n  const { id } = useParams<{ id: string }>()\n  const [currentPage, setPage] = useState(1)\n  const [videoState, setVideoState] = useVideoCustomState(id)()\n  const offset = (currentPage - 1) * perPage\n  return (\n    <>\n      <List\n        className=\"comment-list\"\n        header={`${comments.length} ${text}`}\n        itemLayout=\"horizontal\"\n        dataSource={formatNotifies(comments.slice(offset, offset + perPage), videoState, setVideoState)}\n        renderItem={(item) => (\n          <li>\n            <Comment actions={item.actions} author={item.author} avatar={item.avatar} content={item.content} datetime={item.datetime} />\n          </li>\n        )}\n      />\n      <Pagination\n        current={currentPage}\n        onChange={(p) => setPage(p)}\n        total={comments.length}\n        showSizeChanger={false}\n        defaultPageSize={COMMENTS_PER_PAGE}\n        showTotal={(total, range) => `${range[0]}-${range[1]} of ${total} ${text}`}\n        defaultCurrent={1}\n      />\n    </>\n  )\n}\n\nexport function generateNotifiesForRound(notifies: VideoComment[], currentState: CustomVideoState) {\n  const withoutSpecialCases = notifies\n    .filter((n) => !(currentState.messages[n.id] ?? defaultMessageState).priority)\n    .filter((n) => !(currentState.messages[n.id] ?? defaultMessageState).hidden)\n    .filter((n) => !(currentState.messages[n.id] ?? defaultMessageState).down)\n  const priority = notifies.filter((n) => (currentState.messages[n.id] ?? defaultMessageState).priority)\n  const movedDown = notifies.filter((n) => (currentState.messages[n.id] ?? defaultMessageState).down && !priority.includes(n))\n  return [...priority, ...withoutSpecialCases, ...movedDown]\n}\n\nexport function generateNotifies(comments: VideoComment[], pageName: string) {\n  return uniqBy(\n      orderBy(comments, (c) => DateTime.fromISO(c.created_time).toMillis(), 'asc').filter(\n        (c) => c.message.includes('!') && c.message.toLowerCase().includes('notify') && (c.from.name !== pageName ?? 'UNKNOWN PAGE')\n      ),\n      (c) => c.from.id\n    )\n  \n}\n","import { Button } from 'antd';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { LiveVideo } from '../definitions';\nimport { useParams } from 'react-router-dom';\nimport { loadCachedMessages } from '../loadCachedMessages';\nimport { PageContext, PageContextValue } from '../PageContext';\nimport { useVideoCustomState } from './util';\nimport { generateNotifies } from './Notifies';\nimport { sampleSize } from 'lodash';\nimport { VideoComment } from '../util/fb.definitions';\n\nexport function GenerateGiveawayWinners() {\n  const { id } = useParams<{ id: string; }>();\n  const { page, videos } = useContext(PageContext) as PageContextValue;\n  const [messages, loadMessages] = useState<VideoComment[]>([]);\n  const [videoState, setVideoState] = useVideoCustomState(id)();\n  const video = videos.find(v => v.id === id) as LiveVideo;\n\n  useEffect(() => {\n    const effect = async () => {\n      loadMessages(await loadCachedMessages(id));\n    };\n    effect();\n  });\n\n  if (messages.length === 0 || video.status === 'LIVE' || (videoState.winners?.length ?? 0) > 0) {\n    return <></>;\n  }\n\n  const notifies = generateNotifies(messages, page.name);\n\n  return <Button type=\"ghost\" onClick={() => {\n    const winners = sampleSize(notifies, 3).map(n => n.from);\n    setVideoState(current => ({ ...current, winners }));\n  }}>Giveaway!</Button>;\n}\n","import { PageHeader, Button, Tag, Typography, Row, Comment } from 'antd';\nimport './VideoHeader.css'\nimport React, { FC } from 'react';\nimport { LiveVideo } from '../definitions';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { DateTime } from 'luxon';\nimport { GenerateGiveawayWinners } from './GenerateGiveawayWinners';\nimport { useVideoCustomState } from './util';\n\nconst { Paragraph } = Typography;\n\nconst Content = ({ children, extraContent }: any) => {\n  return (\n    <Row>\n      <div style={{ flex: 1 }}>{children}</div>\n      <div className=\"image\">{extraContent}</div>\n    </Row>\n  );\n};\n\nexport interface VideoHeaderProps {\n  liveVideo: LiveVideo\n}\n\nfunction WinnersList() {\n  const { id } = useParams<{ id: string; }>();\n  const [videoState] = useVideoCustomState(id)();\n\n  if ((videoState.winners?.length ?? 0) === 0) {\n    return <></>;\n  }\n\n  return <>{videoState.winners!.map(w => <Comment key={`winner-${w.id}`} avatar={w.picture.data.url} author={w.name} content=\"Giveaway Winner\" />)}</>\n}\n\nexport const VideoHeader: FC<VideoHeaderProps> = (props) => {\n  const { liveVideo } = props\n  const history = useHistory()\n  const videoTime = DateTime.fromISO(liveVideo.creation_time)\n  return (\n    <PageHeader\n      title={liveVideo.title}\n      onBack={() => history.goBack()}\n      className=\"site-page-header\"\n      subTitle={videoTime.toLocaleString(DateTime.DATETIME_MED)}\n      tags={<Tag color=\"blue\">{liveVideo.status}</Tag>}\n      extra={[\n        <Button key=\"1\" type=\"primary\" target=\"_blank\" href={`https://facebook.com/${liveVideo.permalink_url}`}>\n          Open\n      </Button>,\n        <GenerateGiveawayWinners key=\"2\" />\n      ]}\n      avatar={{ src: liveVideo.video.icon }}\n    >\n      <Content\n        extraContent={\n          <img\n            src={liveVideo.video.picture}\n            alt={liveVideo.title}\n            width=\"100%\"\n          />\n        }\n      >\n        <Paragraph>\n          {liveVideo.description}\n        </Paragraph>\n        <WinnersList />\n      </Content>\n    </PageHeader>\n  )\n}","import { useState, useEffect } from \"react\"\nimport { LiveVideo, PageToken, LiveVideos } from \"../definitions\"\nimport { getPageToken } from \"../util/fb\"\n\nexport function useFacebookPage(pageId: string): [boolean, PageToken | undefined, LiveVideo[]] {\n  const [loadingVideos, setLoadingVideos] = useState(true)\n  const [videos, setVideos] = useState<LiveVideo[]>([])\n  const [pageData, setPageData] = useState<PageToken>()\n\n  useEffect(() => {\n    if (loadingVideos === true) {\n      const effect = async () => {\n        const tokenItem = await getPageToken(pageId)\n        FB.api(\n          `/${pageId}/live_videos`,\n          'get',\n          {\n            access_token: tokenItem?.access_token,\n            fields: 'status,creation_time,broadcast_start_time,description,embed_html,id,live_views,title,permalink_url,video{id,picture,icon}'\n          },\n          function (response: LiveVideos) {\n            setLoadingVideos(true)\n            setVideos(response.data)\n            setPageData(tokenItem)\n            setLoadingVideos(false)\n          }\n        )\n      }\n      effect()\n    }\n  }, [loadingVideos, pageId])\n\n  return [loadingVideos, pageData, videos]\n}\n","import React, { FC, useContext, useEffect, useState } from 'react'\nimport { Card, Col, List, Row, Comment, Pagination, Layout, Spin, Slider } from 'antd'\nimport './App.css'\nimport { Breadcrumb } from 'antd'\nimport { LoadingOutlined, VideoCameraOutlined } from '@ant-design/icons'\nimport { LiveVideo } from './definitions'\nimport { sortBy, uniqBy } from 'lodash'\nimport { Redirect, Route, Switch, useHistory, useParams, useRouteMatch } from 'react-router-dom'\nimport {\n  FbApiCall,\n  FbParams,\n  getAllResults,\n  useLastSelectedVideoInfo,\n  useLastSelectedVideoComments,\n  usePersistedVideoData\n} from './util/fb'\nimport { batchInsertApiMessages } from './util/messages'\nimport { VideoHeader } from './live_videos/VideoHeader'\nimport { PageContext, PageContextValue } from './PageContext'\nimport { FacebookPaginatedResponse, VideoComment } from './util/fb.definitions'\nimport { COMMENTS_PER_PAGE, formatComments, useVideoCustomState } from './live_videos/util'\nimport { generateNotifies, generateNotifiesForRound, NotifiesList } from './live_videos/Notifies'\nimport { DateTime } from 'luxon'\nimport { useFacebookPage } from './hooks/useFacebookPage'\nimport { loadCachedMessages } from './loadCachedMessages'\nconst { Content } = Layout\n\nconst messagesParams = 'from{name,id,picture},message,id,created_time,like_count,live_broadcast_timestamp'\nconst defaultMessageParams: Omit<FbParams, 'access_token'> = {\n  limit: 100,\n  live_filter: 'no_filter',\n  order: 'reverse_chronological',\n  fields: messagesParams\n}\n\nconst VideoCard: FC<{ video: LiveVideo; span?: number; onClick?: ((selected: LiveVideo) => void) | undefined }> = (props) => {\n  const { video, span = 8, onClick = () => { } } = props\n  const icon = video.status === 'LIVE' ? <LoadingOutlined /> : <VideoCameraOutlined />\n  return (\n    <Col span={span}>\n      <Card\n        bordered={false}\n        hoverable={video.status === 'LIVE'}\n        onClick={() => onClick(video)}\n        cover={<img alt={video.title} src={video.video.picture} />}\n      >\n        <Card.Meta title={video.title} description={video.description} avatar={icon} />\n      </Card>\n    </Col>\n  )\n}\n\ninterface HasVideos {\n  videos: LiveVideo[]\n}\n\ninterface CurrentVideosProp extends HasVideos { }\nconst VIDEOS_PER_PAGE = 6\nconst CurrentVideos: FC<CurrentVideosProp> = (props) => {\n  const { videos } = props\n  const [currentPage, setPage] = useState(1)\n  const history = useHistory()\n  const offset = (currentPage - 1) * VIDEOS_PER_PAGE\n  const { pageId } = useParams<{ pageId: string }>()\n  return (\n    <Content style={{ margin: '0 16px' }}>\n      <Breadcrumb style={{ margin: '16px 0' }}>\n        <Breadcrumb.Item>LiaKumStreams</Breadcrumb.Item>\n        <Breadcrumb.Item>Live Videos</Breadcrumb.Item>\n      </Breadcrumb>\n      <div className=\"site-layout-background\" style={{ padding: 24, minHeight: 360 }}>\n        <Row gutter={16}>\n          {videos.slice(offset, offset + VIDEOS_PER_PAGE).map((v) => (\n            <VideoCard key={`video-${v.id}`} video={v} onClick={(v) => history.push(`/${pageId}/live_videos/${v.id}`)} />\n          ))}\n        </Row>\n        <Row gutter={16}>\n          <Pagination\n            current={currentPage}\n            onChange={(p) => setPage(p)}\n            total={videos.length}\n            showSizeChanger={false}\n            defaultPageSize={VIDEOS_PER_PAGE}\n            defaultCurrent={1}\n          />\n        </Row>\n      </div>\n    </Content>\n  )\n}\n\ninterface CommentsListProps {\n  comments: VideoComment[]\n  perPage: number\n  text: string\n}\nconst CommentsList: FC<CommentsListProps> = (props) => {\n  const { comments, perPage, text } = props\n  const [currentPage, setPage] = useState(1)\n  const offset = (currentPage - 1) * perPage\n  return (\n    <>\n      <List\n        className=\"comment-list\"\n        header={`${comments.length} ${text}`}\n        itemLayout=\"horizontal\"\n        dataSource={formatComments(comments.slice(offset, offset + perPage))}\n        renderItem={(item) => (\n          <li>\n            <Comment actions={item.actions} author={item.author} avatar={item.avatar} content={item.content} datetime={item.datetime} />\n          </li>\n        )}\n      />\n      <Pagination\n        current={currentPage}\n        onChange={(p) => setPage(p)}\n        total={comments.length}\n        showSizeChanger={false}\n        defaultPageSize={COMMENTS_PER_PAGE}\n        showTotal={(total, range) => `${range[0]}-${range[1]} of ${total} ${text}`}\n        defaultCurrent={1}\n      />\n    </>\n  )\n}\n\nfunction printRoundLine(name: string, round: number, roundSize: number) {\n  return `${round % roundSize === 0 ? '----Ronda----\\n' : ''}${name}\\n`\n}\n\nconst CommentsFeed: FC<{ video: LiveVideo }> = (props) => {\n  const { video } = props\n  const { page } = useContext(PageContext) as PageContextValue\n  const [loaded, setLoaded] = useState(false)\n  const [comments, setComments] = useState<VideoComment[]>([])\n  const [, setLastSelectedVideoComments] = useLastSelectedVideoComments()\n  const [videoState, setVideoState] = useVideoCustomState(video.id)()\n  const { pageId } = useParams<{ pageId: string }>()\n  const { roundSize } = videoState\n  const setRoundSize = (roundSize: number) => setVideoState((prev) => ({ ...prev, roundSize }))\n  useEffect(() => {\n    const composedSetComments: React.Dispatch<React.SetStateAction<VideoComment[]>> = (params) => {\n      setLastSelectedVideoComments(params)\n      return setComments(params)\n    }\n    let since = video.broadcast_start_time\n    const effect = async () => {\n      if (video.status !== 'LIVE') {\n        composedSetComments(sortBy(await loadCachedMessages(video.id), (m) => DateTime.fromISO(m.created_time).toMillis()).reverse())\n        setLoaded(true)\n        return\n      }\n      let comments = await FbApiCall<FacebookPaginatedResponse<VideoComment>>(`${video.id}/comments`, {\n        ...defaultMessageParams,\n        access_token: page.access_token\n      })\n      const allResults = await getAllResults(comments)\n      composedSetComments(allResults)\n      if (allResults.length > 0) {\n        since = allResults[0].created_time\n      }\n      setLoaded(true)\n      return\n    }\n    const interval = setInterval(async () => {\n      if (video.status !== 'LIVE') {\n        return\n      }\n      const newComments = await FbApiCall<FacebookPaginatedResponse<VideoComment>>(`${video.id}/comments`, {\n        ...defaultMessageParams,\n        since,\n        access_token: page.access_token\n      })\n      if (newComments.data.length > 0) {\n        since = newComments.data[0].created_time\n      }\n      composedSetComments((prev) => uniqBy([...newComments.data, ...prev], 'id'))\n    }, 5000)\n    effect()\n    return () => clearInterval(interval)\n  }, [loaded, video.id, pageId, video.status, page.access_token, video.broadcast_start_time, setLastSelectedVideoComments])\n\n  const notifies = generateNotifies(comments, page.name)\n\n  const filteredNotifies = generateNotifiesForRound(notifies, videoState)\n\n  return (\n    <>\n      <Col span={8}>\n        <Card title=\"Comments\">\n          <CommentsList text=\"replies\" comments={comments} perPage={COMMENTS_PER_PAGE} />\n        </Card>\n      </Col>\n      <Col span={8}>\n        <Card title=\"Notifies\">\n          <NotifiesList text=\"notifies\" comments={notifies} perPage={COMMENTS_PER_PAGE} />\n        </Card>\n      </Col>\n\n      <Col span={8}>\n        <Card title=\"Rounds by Notifies\">\n          Size: <Slider defaultValue={5} tooltipVisible value={roundSize} onChange={(v: number | any) => typeof v === 'number' && setRoundSize(v)} />\n          <pre>{filteredNotifies.map((n, i) => printRoundLine(n.from.name, i, roundSize))}</pre>\n        </Card>\n      </Col>\n    </>\n  )\n}\n\ninterface LiveVideoDashboardProps extends HasVideos { }\nconst LiveVideoDashboard: FC<LiveVideoDashboardProps> = (props) => {\n  const { page } = useContext(PageContext) as PageContextValue\n  const [persistedVideoData, setPersistedVideoData] = usePersistedVideoData()\n  const [, setLastSelectedVideo] = useLastSelectedVideoInfo()\n  const [loading, setLoading] = useState(true)\n  const { id } = useParams<{ id: string }>()\n  const { videos } = props\n  const video = videos.find((v) => v.id === id)\n\n  useEffect(() => {\n    const effect = async () => {\n      setLastSelectedVideo({ page, id: video!.id })\n      if (video !== undefined && persistedVideoData[video.id] === true) {\n        setLoading(false)\n        return\n      }\n      if (video === undefined || video.status === 'LIVE') {\n        setLoading(false)\n        return\n      }\n\n      let comments = await FbApiCall<FacebookPaginatedResponse<VideoComment>>(`${video.id}/comments`, {\n        ...defaultMessageParams,\n        access_token: page.access_token\n      })\n      const allResults = await getAllResults(comments)\n      await batchInsertApiMessages(allResults, video.id, page.id)\n      setPersistedVideoData((prev) => ({ ...prev, [video.id]: true }))\n      setLoading(false)\n    }\n    effect()\n  }, [loading, setPersistedVideoData, setLastSelectedVideo, persistedVideoData, video, page])\n\n  if (video === undefined) {\n    return <Redirect to=\"/live_videos\" />\n  }\n  return (\n    <Content style={{ margin: '0 16px' }}>\n      <Breadcrumb style={{ margin: '16px 0' }}>\n        <Breadcrumb.Item>{page.name}</Breadcrumb.Item>\n        <Breadcrumb.Item>Live Videos</Breadcrumb.Item>\n        <Breadcrumb.Item>{video.title}</Breadcrumb.Item>\n      </Breadcrumb>\n\n      <div className=\"site-layout-background\" style={{ padding: 24, minHeight: 360 }}>\n        <Row gutter={16}>\n          <VideoHeader liveVideo={video} />\n        </Row>\n        <Row gutter={16}>{loading ? <Spin /> : <CommentsFeed video={video} />}</Row>\n      </div>\n    </Content>\n  )\n}\n\nexport const LiveVideosDashboard: FC = () => {\n  const { pageId } = useParams<{ pageId: string }>()\n  const [loadingVideos, page, videos] = useFacebookPage(pageId)\n  let match = useRouteMatch()\n\n  if (page === undefined) {\n    return <Spin />\n  }\n\n  return (\n    <PageContext.Provider value={{ page, videos }}>\n      <Switch>\n        <Route path={`${match.path}/:id`}>{loadingVideos ? <Spin size=\"large\" /> : <LiveVideoDashboard videos={videos} />}</Route>\n        <Route path={match.path}>{loadingVideos ? <Spin size=\"large\" /> : <CurrentVideos videos={videos} />}</Route>\n      </Switch>\n    </PageContext.Provider>\n  )\n}\n\n\n","import { SettingOutlined } from '@ant-design/icons'\nimport { Breadcrumb, Button, Form, Input, Layout, Modal } from 'antd'\nimport React, { FC, useState } from 'react'\nimport { useChatBoxUrlState } from './util/streamlabs'\n\ninterface Values {\n  chatboxUrl: string\n}\n\ninterface CollectionCreateFormProps {\n  visible: boolean\n  onCreate: (values: Values) => void\n  onCancel: () => void\n}\n\nconst CollectionCreateForm: React.FC<CollectionCreateFormProps> = ({ visible, onCreate, onCancel }) => {\n  const [chatboxUrl] = useChatBoxUrlState()\n  const [form] = Form.useForm<Values>()\n  return (\n    <Modal\n      visible={visible}\n      title=\"Set Chatbox URL\"\n      okText=\"Set\"\n      cancelText=\"Cancel\"\n      onCancel={onCancel}\n      onOk={() => {\n        form\n          .validateFields()\n          .then((values) => {\n            form.resetFields()\n            onCreate(values as Values)\n          })\n          .catch((info) => {\n            console.log('Validate Failed:', info)\n          })\n      }}\n    >\n      <Form form={form} layout=\"vertical\" name=\"form_in_modal\" initialValues={{ chatboxUrl: chatboxUrl ?? '' }}>\n        <Form.Item name=\"chatboxUrl\" label=\"Chatbox URL\" rules={[{ required: true, message: 'Please input the chatbox url!' }]}>\n          <Input addonAfter={<SettingOutlined />} placeholder=\"https://streamlabs.com/widgets/chat-box/v1/XXXXXXXXXXXXXXXXXXXX\" />\n        </Form.Item>\n      </Form>\n    </Modal>\n  )\n}\n\nconst UpdateChatboxUrl = () => {\n  const [visible, setVisible] = useState(false)\n  const [chatboxUrl, setChatboxUrl] = useChatBoxUrlState()\n\n  const onCreate = (values: Values) => {\n    console.log('Received values of form: ', values)\n    setChatboxUrl(values.chatboxUrl)\n    setVisible(false)\n  }\n\n  return (\n    <>\n      <Button\n        type=\"primary\"\n        onClick={() => {\n          setVisible(true)\n        }}\n      >\n        Update Chatbox URL\n      </Button>\n      {chatboxUrl}\n      <CollectionCreateForm\n        visible={visible}\n        onCreate={onCreate}\n        onCancel={() => {\n          setVisible(false)\n        }}\n      />\n    </>\n  )\n}\n\nconst { Content } = Layout\n\nexport const PageSelector: FC = () => {\n  return (\n    <Content style={{ margin: '0 16px' }}>\n      <Breadcrumb style={{ margin: '16px 0' }}>\n        <Breadcrumb.Item>Home</Breadcrumb.Item>\n      </Breadcrumb>\n      <div className=\"site-layout-background\" style={{ padding: 24, minHeight: 360 }}>\n        <UpdateChatboxUrl />\n      </div>\n    </Content>\n  )\n}\n","import { chunk } from 'lodash'\nimport React, { FC } from 'react'\nimport { generateNotifies, generateNotifiesForRound } from '../live_videos/Notifies'\nimport { useVideoCustomState } from '../live_videos/util'\nimport { useLastSelectedVideoComments, useLastSelectedVideoInfo } from '../util/fb'\nimport './Rounds.css'\n\nexport const RoundsWidget: FC = () => {\n  const [videoInfo] = useLastSelectedVideoInfo()\n  const [comments] = useLastSelectedVideoComments()\n  const [videoState] = useVideoCustomState(videoInfo!.id)()\n  const notifies = generateNotifies(comments, videoInfo!.page.name)\n  const notifiesForRound = generateNotifiesForRound(notifies, videoState)\n  const separateRounds = chunk(notifiesForRound, videoState.roundSize)\n  return (\n    <div id=\"rounds-log\">\n      {separateRounds.map((round, i) => (\n        <div>\n          <h2>{i === 0 ? 'Pa\\'horita' : 'Pal\\'rato'}</h2>\n          <ul>\n          {round.map(n => (\n            <li>{n.from.name}</li>\n          ))}\n          </ul>\n        </div>\n      ))}\n    </div>\n  )\n}\n","import React, { FC } from 'react'\nimport { Redirect, Route, Switch, useRouteMatch } from 'react-router-dom'\nimport { RoundsWidget } from './RoundsWidget'\n\nexport const Widgets: FC = () => {\n  let match = useRouteMatch()\n\n  return (\n    <Switch>\n      <Switch>\n        <Route path={`${match.path}/rounds`}><RoundsWidget /></Route>\n        <Route path={match.path}>This could be a loverly widgets list</Route>\n        <Route path=\"*\"><Redirect to=\"/\" /></Route>\n      </Switch>\n    </Switch>\n  )\n}\n","import { FacebookOutlined, SaveOutlined } from '@ant-design/icons'\nimport { Breadcrumb, Layout, Spin } from 'antd'\nimport Search from 'antd/lib/input/Search'\nimport { reverse, uniqBy } from 'lodash'\nimport React, { FC, useContext, useEffect, useState } from 'react'\nimport { useParams } from 'react-router-dom'\nimport { useFacebookPage } from '../hooks/useFacebookPage'\nimport { PageContext, PageContextValue } from '../PageContext'\nimport { FbApiCall, getAllResults } from '../util/fb'\nimport { FacebookPaginatedResponse } from '../util/fb.definitions'\n\n\ninterface GiveawayFbData {\n  comments: FacebookPaginatedResponse<{\n    message: string,\n    from: {\n      id: string,\n      name: string\n    },\n    message_tags?: any[]\n  }>,\n  reactions: FacebookPaginatedResponse<{\n    id: string\n    name: string\n  }>\n}\n\nconst getPostId = (data: string) => reverse(data.split('/').filter(r => r != null && r !== ''))[0]\nconst hasTagged = (c: GiveawayFbData['comments']['data'][0]) => (c.message_tags?.length ?? 0) > 0 || c.message.split(/\\s/g).length >= 2\n\nconst GiveawayData = () => {\n  const { page } = useContext(PageContext) as PageContextValue\n  const [postUrl, setPostUrl] = useState<string>()\n  const [comments, setComments] = useState<GiveawayFbData['comments']['data']>([])\n  const [reactions, setReactions] = useState<GiveawayFbData['reactions']['data']>([])\n  const postId = getPostId(postUrl ?? '')\n  useEffect(() => {\n    if (postId === undefined || postUrl === '') {\n      return\n    }\n    const effect = async () => {\n      const reply = await FbApiCall<GiveawayFbData>(`${page.id}_${postId}`, { fields: 'comments.limit(100).live_filter(no_filter).filter(stream){message,from,message_tags,id},reactions.limit(100){username,name,id}', access_token: page.access_token })\n      const allComments = await getAllResults(reply.comments)\n      const allReactions = await getAllResults(reply.reactions)\n      setComments(allComments)\n      setReactions(allReactions)\n      console.log(reply)\n      console.log(allComments)\n      console.log(allReactions)\n    }\n    effect()\n  }, [postUrl, page.id, page.access_token, postId])\n\n  const didReact = reactions.map(r => r.id)\n  const participants = uniqBy(comments.filter(hasTagged).filter(c => didReact.includes(c.from.id)), (c) => c.from.id)\n  return (\n    <>\n      <Search\n        prefix={<FacebookOutlined />}\n        placeholder={`https://www.facebook.com/${page.name}/photos/a.00000000000000000/XXXXXXXXXXXXX/`}\n        defaultValue={postUrl}\n        enterButton={<SaveOutlined />}\n        size=\"large\"\n        onSearch={(value) => setPostUrl(value)}\n      />\n      <p>Total: {participants.length}</p>\n      {participants.map(p => (\n        <p key={`part-list-${p.from.id}`}><small>{p.from.id}</small> {p.from.name}</p>\n      ))}\n    </>\n  )\n}\n\nconst { Content } = Layout\n\nexport const AdvancedGiveaway: FC = () => {\n  const { pageId } = useParams<{ pageId: string }>()\n  const [loaded, page, videos] = useFacebookPage(pageId)\n\n  if (page === undefined) {\n    return <Spin />\n  }\n\n  return (\n    <PageContext.Provider value={{ page, videos }}>\n      <Content style={{ margin: '0 16px' }}>\n        <Breadcrumb style={{ margin: '16px 0' }}>\n          <Breadcrumb.Item>{page?.name}</Breadcrumb.Item>\n          <Breadcrumb.Item>Advanced Giveaway</Breadcrumb.Item>\n        </Breadcrumb>\n        <div className=\"site-layout-background\" style={{ padding: 24, minHeight: 360 }}>\n          {!loaded && <GiveawayData />}\n        </div>\n      </Content>\n    </PageContext.Provider>\n  )\n}\n","import React, { FC, useEffect, useState } from 'react'\nimport './App.css'\nimport { Layout, Menu, Spin } from 'antd'\nimport { DashboardOutlined, FacebookOutlined, GiftOutlined, UnorderedListOutlined } from '@ant-design/icons'\nimport { BrowserRouter, Link, Route, Switch, useLocation } from 'react-router-dom'\nimport { LiveVideosDashboard } from './LiveVideoDashboard'\nimport { PageSelector } from './PageSelector'\nimport { PageToken, PageTokensResponse } from './definitions'\nimport { fetchStreamlabsConfig, isValidUrl, useChatBoxUrlState } from './util/streamlabs'\nimport { getPagesTokens } from './util/fb'\nimport { Widgets } from './widgets/Widgets'\nimport { AdvancedGiveaway } from './giveaway/AdvancedGiveaway'\n\nconst { Footer, Sider } = Layout\nconst { SubMenu } = Menu\n\nfunction getSelectedMenuItemKey(path: string) {\n  if (path.includes('/live_videos')) {\n    const [, pageId] = path.split('/')\n    return [`page-${pageId}-live_videos`]\n  }\n  if (path.includes('/advanced_giveaway')) {\n    const [, pageId] = path.split('/')\n    return [`page-${pageId}-advanced_giveaway`]\n  }\n  return ['home']\n}\n\ninterface SidebarProps {\n  showPageSelector: boolean\n}\n\nconst Sidebar: FC<SidebarProps> = ({ showPageSelector }) => {\n  const [loading, setLoading] = useState(true)\n  const [pages, setPages] = useState<PageToken[]>([])\n  useEffect(() => {\n    const effect = async () => {\n      if (showPageSelector) {\n        const tokensResponse: PageTokensResponse = await getPagesTokens()\n        setPages(tokensResponse.data)\n        setLoading(false)\n      }\n    }\n    effect()\n  }, [loading, showPageSelector])\n  const [collapsed, setCollapsed] = useState(false)\n  const onCollapse = () => setCollapsed(!collapsed)\n  const match = useLocation()\n\n  console.log(match)\n\n  return (\n    <Sider collapsible collapsed={collapsed} onCollapse={onCollapse}>\n      <div className=\"logo\" />\n      <Menu theme=\"dark\" defaultSelectedKeys={['home']} mode=\"inline\" selectedKeys={getSelectedMenuItemKey(match.pathname)}>\n        <Menu.Item key=\"home\" icon={<DashboardOutlined />}>\n          <Link to=\"/\">Dashboard</Link>\n        </Menu.Item>\n        {pages.map((p) => (\n          <SubMenu key={`page-${p.id}`} icon={<FacebookOutlined />} title={p.name}>\n            <Menu.Item key={`page-${p.id}-live_videos`} icon={<UnorderedListOutlined />}>\n              <Link to={`/${p.id}/live_videos`}>Live Videos</Link>\n            </Menu.Item>\n            <Menu.Item key={`page-${p.id}-advanced_giveaway`} icon={<GiftOutlined />}>\n              <Link to={`/${p.id}/advanced_giveaway`}>Advanced Giveaway</Link>\n            </Menu.Item>\n          </SubMenu>\n        ))}\n      </Menu>\n    </Sider>\n  )\n}\n\nconst NormalPage: FC = () => {\n  const [chatboxUrl] = useChatBoxUrlState()\n  const [loggedIn, setLoggedIn] = useState(false)\n  useEffect(() => {\n    const effect = async () => {\n      if (loggedIn === false) {\n        try {\n          if (isValidUrl()) {\n            await fetchStreamlabsConfig()\n            setLoggedIn(true)\n          }\n        } catch (error) {\n          console.error(error)\n        }\n      }\n    }\n    effect()\n  }, [loggedIn, chatboxUrl])\n  return (\n    <Layout style={{ minHeight: '100vh' }}>\n      <Sidebar showPageSelector={loggedIn} />\n      <Layout className=\"site-layout\">\n        {loggedIn === false && typeof chatboxUrl === 'string' && <Spin />}\n        {loggedIn ? (\n          <Switch>\n            <Route path=\"/:pageId/live_videos\">\n              <LiveVideosDashboard />\n            </Route>\n            <Route path=\"/:pageId/advanced_giveaway\">\n              <AdvancedGiveaway />\n            </Route>\n            <Route path=\"/\">\n              <PageSelector />\n            </Route>\n          </Switch>\n        ) : (\n          <PageSelector />\n        )}\n\n        <Footer style={{ textAlign: 'center' }}>Ale Ornelas ©2020</Footer>\n      </Layout>\n    </Layout>\n  )\n}\n\nconst App: FC = () => {\n  return (\n    <BrowserRouter basename=\"alegaming_site\">\n      <Switch>\n        <Route path=\"/widgets*\">\n          <Widgets />\n        </Route>\n        <Route path=\"*\">\n          <NormalPage />\n        </Route>\n      </Switch>\n    </BrowserRouter>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\ndeclare global {\n  interface Window {\n    fbAsyncInit: () => void;\n  }\n}\n\nwindow.fbAsyncInit = function () {\n  FB.init({\n    appId: '662939310992071',\n    autoLogAppEvents: true,\n    xfbml: true,\n    cookie: true,\n    version: 'v8.0'\n  });\n  ReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n  );\n};\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}